# Evaluation



- **Status:** ACCEPTED
- **Application Document:** https://github.com/w3f/Grants-Program/blob/master/applications/Primis.md
- **Milestone:** 1
- **Kusama Identity:** randombishop (https://sub.id/5Gnixfp6vnznRkr91JgwkxYnCJCyHr8EaBzYfFsUKcTMzVYF)
- **Previously successfully merged evaluation:** N/A



| Number | Deliverable                    | Accepted | Link                                                             | Evaluation Notes                                            | 
| -----: | ------------------------------ | -------- | ---------------------------------------------------------------- | ----------------------------------------------------------- |
|    0a. | License                        | Yes      | [MIT](https://github.com/Primis-Labs/client/blob/main/LICENSE)   | MIT                                                         |
|    0b. | Documentation                  | Yes      | [README](https://github.com/Primis-Labs/client)                  | See section 0b.                                             |
|    0c. | Testing Guide                  | Yes      | [Tests](https://github.com/Primis-Labs/client/blob/main/doc/Primis%20Web3%20Desktop%20Testing%20Guide.md) |See section 0c.     |
|    0d. | Docker                         | N/A      |                                                                  | Desktop application.                                        |
|     1. | Build app structure            | Yes      | [Website](https://primis.cc/)                                    |                                                             | 
|     2. | Implement wallet view          | Yes      |                                                                  |                                                             |
|     3. | Build Polkadot ECO wallet      | Yes      |                                                                  |                                                             |
|     4. | NFT assets management          | Yes      |                                                                  |                                                             |
|     5. | Setup Primis NFT avatar        | Yes      |                                                                  |                                                             |



## General Notes

There clearly was a great effort put into this first iteration, posing a nice foundation for a desktop wallet app.

The source code is well organized and cleanly written, modulo some typos here and there and a lack of comments and documentation.

All issues reported in this evaluation can be summarized into a documentation bucket, plus some small bugs or features that still need a bit of polishing.

As I am not calibrated yet to decide which issues are blocking vs ok to move forward, I will defer to a W3F officer to decide how to proceed.


## First Evaluation

### 0b. Documentation

**Expectation** 
- Inline document of code and tutorial docs that explain how users can install it.

**Assessment**
- Installing from source is straightforward with npm install or yarn install. 
- But yarn didn’t work in my machine.
- Warning: 
```warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json```
- Installing with the provided packages in the website is accessible to any user.
- MAC dmg :white_check_mark:
- Windows installer :white_check_mark:
- The code is easy to understand but lacks some high level pointers and comments.

**Recommendation**
- Keep either npm package lock or yarn’s lock file. By having both, it’s unclear which one is the source of truth. I recommend keeping only one and making sure it works in different environments.
- See recommendations about documentation in the following sections of this evaluation.


### 0c. Testing

**Expectation**
- Unit tests will cover all core functions to ensure functionality and viability. We will describe how to run the tests in the tutorial.

**Assessment**
- A manual testing guide is provided as a google spreadsheet:
[doc](https://docs.google.com/spreadsheets/d/1DccCJUEu7HLUpQYrh6QBfJ1wuRyPeMBWoAsppco-nEU/edit?usp=sharing)
- Successfully ran the test suite against the MAC installed version and the version running locally from source. Most tests pass except few scenarios reported in this evaluation.
- Running the tests with npm run test fails:
```
Test Suites: 4 failed, 4 total
Tests:       6 failed, 2 passed, 8 total
```

**Recommendation**
- It is generally hard to automate the testing of front end applications, so I recommend providing a document that explains the testing approach and which modules can be automatically unit tested. Automated unit tests should cover at least the services in `api` and `store` source folders.
- Move the google spreadsheet to a text file and include it in the GitHub repo so that we can keep track of changes, decentralize contributions, and enrich the test suite over time as we discover bugs and edge cases.
- Add edge case scenarios to the testing guide. Example: sending a transaction that will fail because of not enough gas or existential deposit issue.
- Add “how to run tests” in the main README file.




### 1. Build app structure

**Expectation**
- We will have the core structure of the application in place.

**Assessment**
- The code structure is clean.
- Some typos here and there (receive/receive, chart/chat, brower/browser) 

**Recommendation**
- Include some documentation for the overall architecture and details about the key components. Router, API and Store in particular deserve more inline code comments and explanations so that new devs can be onboarded. Also, given the sensitivity and the critical responsibility of a wallet application, the documentation of the API and Store modules should include a note about the approach to safety.
- The English texts are hard coded all over the code. Would be better if the app was internationalized with clean dictionary files for future languages.


### 2. Basic Wallet Features

**Expectation**
- Create, import, view, and transfer functions will be provided by the integrated Polkadot wallet.


**Assessment**
- Create a new wallet :white_check_mark:
- Receive DOT :white_check_mark:
- Receive KSM :white_check_mark:
- Receive ACA :white_check_mark:
- Receive GLMR :warning: 
  * The `receive` panel only shows the substrate format, not the EVM format.
  * Also, the copy button doesn't work
- Receive ASTR :warning: Could not acquire ASTR to test.
- Receive ROC :warning: Correct balance is showing but the token symbol is KSM instead of ROC, and in the receive panel it shows GLMR.
- Send in different networks 
  * Tested on DOT, KSM, ACA and ROC :white_check_mark:
  * Failed transactions show as success. :warning: 
- Balances show in each network :warning:
  * works but sometimes gets stuck until moving out and into the view.
  * Acala network shows ACA balance but not other tokens owned in that network (tried with DOT and aUSD, and neither did show.)
  * Balance doesn’t update automatically after receiving.
- Export wallet :white_check_mark:
  * The generated json file worked in Primis
  * Worked in PolkadotJS extension as well
  * But I couldn’t import it in Metamask to interact with Moonbeam. :warning:
- Log out of a wallet :white_check_mark:
- Import a wallet :white_check_mark:


**Recommendation**
- Clarify expectations about which assets should show when selecting networks.
- Provide EVM formatted address for Moonbeam network and fix copy button.
- Provide correct feedback about success or failure of transactions.
- Investigate why balance fetching sometimes gets stuck.
- Auto-refresh account balance or provide a refresh button?



### 3. Ecosystem features

**Expectation**
- Checking, sending, receiving assets of Kusama, Moonbeam, and Acala will be provided for Primis users.

**Assessment**
- Kusama assets :white_check_mark:
  * NFTs in RMRK2 :warning: one of 2 NFTs I tested with doesn't show the image
  * NFTs in RMRK1 (Could not test because trading on RMRK1 is temporarily disabled)
- Moonbeam assets: didn't test, couldn't load the wallet in Metamask.
- Acala assets 
  * Only ACA is showing :white_check_mark:
  * aUSD and DOT not showing :warning:
- Sending and receiving the native tokens in the networks :white_check_mark:
- it’s unclear which other assets are supported.
- Transactions triggered from other places don’t show in the app.

**Recommendation**
- Clarify expectations for this iteration.
- Show wallet transactions in the records log when they happened outside the app.


### 4. NFT assets management

**Expectation**
- NFT assets can be viewed, sent, and received under Primis.

**Assessment**
- Tested with a couple of NFTs in Kusama / RMRK2 :white_check_mark:
- One NFT shows in the app but the image is missing, the other one shows the image :warning:
- Sending NFTs is not implemented yet. :warning:

**Recommendation**
- Implement NFT sending.
- Check the image display issue, I suspect it to be related to the collection art being stored in chain.
- Would be nice if the NFT had a caption, like collection name and id, something to identify it when image is not enough.




# Final evaluation

- The fixes and recommendation implementations can be tracked [here](https://github.com/w3f/Grant-Milestone-Delivery/pull/587)

- The most important issues were resolved and delivered.

- A couple of optional issues will be kept in the backlog for future iterations:
* The English texts are hard coded all over the code. Would be better if the app was internationalized with clean dictionary files for future languages.
* Show wallet transactions in the records log when they happened outside the app.

- Milestone 1 accepted.

